\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{config/thesis}[2024/03/21 Custom thesis package]

% Required packages
\RequirePackage{hyperref}
\RequirePackage{etoolbox}
\RequirePackage{listings}
\RequirePackage{color}

% Abstract styling
\renewenvironment{abstract}{
    \thispagestyle{empty}
    \null\vfil
    \begin{center}
        \setlength{\parskip}{0pt}
        \begin{large}
            \bfseries Abstract
        \end{large}
    \end{center}
    \bigskip
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{0.8em}
}{
    \vfil\null
}

% Define thesis variables
\def\thesistitle#1{\def\ttitle{#1}}
\def\thesiscontext#1{\def\tcontext{#1}}
\def\thesistype#1{\def\ttype{#1}}
\def\thesisdate#1{\def\tdate{#1}}
\def\thesissemester#1{\def\tsemester{#1}}
\def\keywords#1{\def\keywordnames{#1}}

% Author information
\def\author#1{\def\authorname{#1}}
\def\authorinstitute#1{\def\authorinstitute{#1}}
\def\degree#1{\def\degreename{#1}}
\def\studyprogram#1{\def\studyprog{#1}}
\def\studyprogramlink#1{\def\studyproglink{#1}}

% Supervisor information
\def\supervisorA#1{\def\supnameA{#1}}
\def\supervisorAmail#1{\def\supmailA{#1}}
\def\supervisorAweb#1{\def\supwebA{#1}}
\def\supervisorAinstitute#1{\def\supinstituteA{#1}}
\def\supervisorAinfo#1{\def\supinfoA{#1}}

% University information
\def\univname{ZHAW School of Engineering}
\def\univlink{https://www.zhaw.ch/en/engineering/}

% Initialize empty supervisor B info
\def\supnameB{}
\def\supinfoB{}

% General document styling
\setlength{\parindent}{0pt}
\setlength{\parskip}{0.8em} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Code Listing Styles (GitHub-inspired theme)
\lstset{
    xleftmargin=2em,     % Add left margin to align with red line
    numbers=left,        % Show line numbers on left
    numbersep=1em,       % Space between numbers and code
    numberstyle=\tiny    % Make numbers smaller
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define GitHub-like colors
\definecolor{ghBackground}{RGB}{246, 248, 250}    % Light gray background
\definecolor{ghComment}{RGB}{110, 119, 129}       % Gray for comments
\definecolor{ghKeyword}{RGB}{215, 58, 73}         % Red for keywords
\definecolor{ghString}{RGB}{16, 99, 3}            % Green for strings
\definecolor{ghBuiltin}{RGB}{111, 66, 193}        % Purple for built-in functions
\definecolor{ghFunction}{RGB}{5, 80, 174}         % Blue for functions
\definecolor{ghNumber}{RGB}{0, 92, 197}           % Blue for numbers
\definecolor{ghFrame}{RGB}{208, 215, 222}         % Border color

% Adjust listing settings for better display
\lstset{
    breaklines=true,
    postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\hookrightarrow\space}},
    frame=false,
    numbers=left,
    numberstyle=\tiny,
    basicstyle=\ttfamily\small,
    captionpos=b,
    belowcaptionskip=1em,
    aboveskip=2em,
    belowskip=2em
}

% GitHub-inspired style
\lstdefinestyle{github}{ 
    basicstyle=\ttfamily\small,
    backgroundcolor=\color{ghBackground},
    commentstyle=\color{ghComment},
    keywordstyle=\color{ghKeyword},
    stringstyle=\color{ghString},
    numberstyle=\tiny\color{ghComment},
    breakatwhitespace=false,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=4,
}

% Extended Python language definition
\lstdefinelanguage{PythonPlus}[]{Python}{
    morekeywords=[1]{as,assert,nonlocal,with,yield,self,True,False,None},
    morekeywords=[2]{__init__,__add__,__mul__,__div__,__sub__,__call__,__getitem__,
                     __setitem__,__eq__,__ne__,__nonzero__,__rmul__,__radd__,__repr__,
                     __str__,__get__,__truediv__,__pow__,__name__,__future__,__all__},
    morekeywords=[3]{object,type,isinstance,copy,deepcopy,zip,enumerate,reversed,
                     list,set,len,dict,tuple,range,append,str,repr},
    morekeywords=[4]{Exception,NameError,IndexError,SyntaxError,TypeError,
                     ValueError,OverflowError,ZeroDivisionError},
    morekeywords=[5]{pd,np,plt,DataFrame,Series,array,sqrt,exp,sin,cos},
    sensitive=true,
    morecomment=[l]\#,
    morestring=[b]",
    morestring=[b]',
}

% GitHub-inspired extended style with multiple keyword colors
\lstdefinestyle{githubex}{
    style=github,
    keywordstyle=[1]\color{ghKeyword},          % Python keywords
    keywordstyle=[2]\color{ghBuiltin},          % Magic methods
    keywordstyle=[3]\color{ghFunction},         % Built-in functions
    keywordstyle=[4]\color{ghKeyword},          % Exceptions
    keywordstyle=[5]\color{ghBuiltin},          % Common libraries
}

% Set githubex as the default style for all listings
\lstset{style=githubex}

